2021-09-29 01:42:26,542 [INFO] Setting up kaggle connector...
2021-09-29 01:42:26,542 [INFO] Installing kaggle...
2021-09-29 01:42:28,197 [INFO] Looking in indexes: https://pypi.org/simple, https://pip.repos.neuron.amazonaws.com
Requirement already satisfied: kaggle in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (1.5.12)
Requirement already satisfied: requests in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (2.25.1)
Requirement already satisfied: python-dateutil in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (2.8.1)
Requirement already satisfied: urllib3 in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (1.26.6)
Requirement already satisfied: python-slugify in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (5.0.2)
Requirement already satisfied: tqdm in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (4.56.0)
Requirement already satisfied: six>=1.10 in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (1.15.0)
Requirement already satisfied: certifi in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (2021.5.30)
Requirement already satisfied: text-unidecode>=1.3 in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from python-slugify->kaggle) (1.3)
Requirement already satisfied: chardet<5,>=3.0.2 in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from requests->kaggle) (4.0.0)
Requirement already satisfied: idna<3,>=2.5 in /home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from requests->kaggle) (2.10)

2021-09-29 01:42:28,197 [INFO] Setting up kaggle directories...
2021-09-29 01:42:28,197 [INFO] kaggle directory already exists:/home/ubuntu/.kaggle.
2021-09-29 01:42:28,197 [INFO] kaggle content directory already exists:/home/ubuntu/content.
2021-09-29 01:42:28,197 [INFO] Reading kaggle token from /home/ubuntu/kaggle.json...
2021-09-29 01:42:28,198 [INFO] Writing kaggle token to /home/ubuntu/.kaggle...
2021-09-29 01:42:28,198 [INFO] Securing kaggle token...
2021-09-29 01:42:28,212 [INFO] 
2021-09-29 01:42:28,212 [INFO] Configuring content directory for kaggle...
2021-09-29 01:42:28,554 [INFO] - path is now set to: /home/ubuntu/content

2021-09-29 01:42:28,555 [INFO] Setting up checkpoint handler...
2021-09-29 01:42:28,555 [INFO] Preparing checkpoint directory...
2021-09-29 01:42:28,757 [INFO] Deleted directory:/home/ubuntu/checkpoints.
2021-09-29 01:42:28,757 [INFO] Created directory:/home/ubuntu/checkpoints.
2021-09-29 01:42:28,757 [INFO] Setting up data handler...
2021-09-29 01:42:28,757 [INFO] Preparing output directory...
2021-09-29 01:42:28,757 [INFO] Directory already exists:/home/ubuntu/output.
2021-09-29 01:42:28,757 [INFO] Setting up device handler...
2021-09-29 01:42:28,758 [INFO] Checking device...
2021-09-29 01:42:28,805 [INFO] Gpu detected. device is set to cuda.
2021-09-29 01:42:28,805 [INFO] octopus has finished setting up the environment.
2021-09-29 01:42:28,805 [INFO] octopus is downloading data...
2021-09-29 01:42:28,806 [INFO] Downloading files for kaggle competition:idl-fall2021-hw1p2...
2021-09-29 01:43:00,597 [INFO] Downloading idl-fall2021-hw1p2.zip to /home/ubuntu/content/competitions/idl-fall2021-hw1p2


2021-09-29 01:43:00,598 [INFO] Unzipping competition files...
2021-09-29 01:44:12,709 [INFO] octopus has finished downloading data.
2021-09-29 01:44:12,710 [INFO] octopus is running the pipeline...
2021-09-29 01:44:12,710 [INFO] Initializing model...
2021-09-29 01:44:12,816 [INFO] Model initialized:
MLP(
  (model): Sequential(
    (lin1): Linear(in_features=1640, out_features=2048, bias=True)
    (bn1): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (drop1): Dropout(p=0.3, inplace=False)
    (ReLU1): ReLU(inplace=True)
    (lin2): Linear(in_features=2048, out_features=2048, bias=True)
    (bn2): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (drop2): Dropout(p=0.3, inplace=False)
    (ReLU2): ReLU(inplace=True)
    (lin3): Linear(in_features=2048, out_features=2048, bias=True)
    (bn3): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (drop3): Dropout(p=0.3, inplace=False)
    (ReLU3): ReLU(inplace=True)
    (lin4): Linear(in_features=2048, out_features=1024, bias=True)
    (bn4): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (drop4): Dropout(p=0.3, inplace=False)
    (ReLU4): ReLU(inplace=True)
    (lin5): Linear(in_features=1024, out_features=512, bias=True)
    (bn5): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (drop5): Dropout(p=0.3, inplace=False)
    (ReLU5): ReLU(inplace=True)
    (lin6): Linear(in_features=512, out_features=71, bias=True)
  )
)
2021-09-29 01:44:16,217 [INFO] Criterion is set:CrossEntropyLoss().
2021-09-29 01:44:16,217 [INFO] Optimizer initialized:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0
)
2021-09-29 01:44:16,217 [INFO] Scheduler initialized:
<class 'torch.optim.lr_scheduler.ReduceLROnPlateau'>
2021-09-29 01:44:16,217 [INFO] Loading data...
2021-09-29 01:44:24,074 [INFO] Loaded 18482968 records as training data.
2021-09-29 01:44:28,511 [INFO] Loaded 1935669 records as validation data.
2021-09-29 01:44:28,883 [INFO] Loaded 1910012 records as test data.
2021-09-29 01:44:28,883 [INFO] DataLoader settings for training dataset:
{'shuffle': True, 'batch_size': 128, 'num_workers': 8, 'pin_memory': True}
2021-09-29 01:44:28,883 [INFO] DataLoader settings for validation dataset:
{'shuffle': False, 'batch_size': 128, 'num_workers': 8, 'pin_memory': True}
2021-09-29 01:44:28,883 [INFO] DataLoader settings for test dataset:
{'shuffle': False, 'batch_size': 128, 'num_workers': 8, 'pin_memory': True}
2021-09-29 01:44:28,883 [INFO] Running epoch 1/20 of training...
/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py:795: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
2021-09-29 02:27:03,942 [INFO] Running epoch 1/20 of evaluation...
2021-09-29 02:27:44,987 [INFO] Running epoch 1/20 of testing...
2021-09-29 02:28:21,120 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch1.20210929.02.28.21.output.csv...
2021-09-29 02:28:23,033 [INFO] stats:{'epoch': 1, 'train_loss': 1.0280367849177752, 'val_loss': 0.8384299665517775, 'val_acc': 0.7388246647541497, 'runtime': 2634.1474969387054}
2021-09-29 02:28:23,034 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.1.pt...
2021-09-29 02:28:23,268 [INFO] Checking early stopping criteria...
2021-09-29 02:28:23,268 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 02:28:23,691 [INFO] NumExpr defaulting to 8 threads.
2021-09-29 02:28:23,699 [INFO] Gathered metrics for epoch 1 from wandb:
     name  epoch   val_acc
0  Run-03    1.0  0.614459
best:	Run-03	0.6144592596983517
model:	Run-03	0.7388246647541497
2021-09-29 02:28:23,705 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-09-29 02:28:23,706 [INFO] Early stopping criteria is not met.
2021-09-29 02:28:23,706 [INFO] Running epoch 2/20 of training...
2021-09-29 03:11:09,050 [INFO] Running epoch 2/20 of evaluation...
2021-09-29 03:11:50,116 [INFO] Running epoch 2/20 of testing...
2021-09-29 03:12:26,667 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch2.20210929.03.12.26.output.csv...
2021-09-29 03:12:28,601 [INFO] stats:{'epoch': 2, 'train_loss': 0.8314875894747323, 'val_loss': 0.7760012732536795, 'val_acc': 0.7582629054864236, 'runtime': 2644.8925292491913}
2021-09-29 03:12:28,601 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.2.pt...
2021-09-29 03:12:28,845 [INFO] Checking early stopping criteria...
2021-09-29 03:12:28,845 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 03:12:29,612 [INFO] Gathered metrics for epoch 2 from wandb:
     name  epoch   val_acc
1  Run-01    2.0  0.449627
best:	Run-01	0.44962710759233393
model:	Run-03	0.7582629054864236
2021-09-29 03:12:29,617 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-09-29 03:12:29,617 [INFO] Early stopping criteria is not met.
2021-09-29 03:12:29,617 [INFO] Running epoch 3/20 of training...
2021-09-29 03:55:10,797 [INFO] Running epoch 3/20 of evaluation...
2021-09-29 03:55:50,970 [INFO] Running epoch 3/20 of testing...
2021-09-29 03:56:27,346 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch3.20210929.03.56.27.output.csv...
2021-09-29 03:56:29,253 [INFO] stats:{'epoch': 3, 'train_loss': 0.7748698707059862, 'val_loss': 0.747325492653793, 'val_acc': 0.7668211868868076, 'runtime': 2639.6331210136414}
2021-09-29 03:56:29,253 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.3.pt...
2021-09-29 03:56:29,484 [INFO] Checking early stopping criteria...
2021-09-29 03:56:29,484 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 03:56:29,808 [INFO] Gathered metrics for epoch 3 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7668211868868076
2021-09-29 03:56:29,808 [INFO] Early stopping criteria is not met.
2021-09-29 03:56:29,810 [INFO] Running epoch 4/20 of training...
2021-09-29 04:39:10,263 [INFO] Running epoch 4/20 of evaluation...
2021-09-29 04:39:50,249 [INFO] Running epoch 4/20 of testing...
2021-09-29 04:40:26,510 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch4.20210929.04.40.26.output.csv...
2021-09-29 04:40:28,439 [INFO] stats:{'epoch': 4, 'train_loss': 0.7414286245963677, 'val_loss': 0.7300082440436003, 'val_acc': 0.7722337858383845, 'runtime': 2638.627326965332}
2021-09-29 04:40:28,440 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.4.pt...
2021-09-29 04:40:28,676 [INFO] Checking early stopping criteria...
2021-09-29 04:40:28,676 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 04:40:28,986 [INFO] Gathered metrics for epoch 4 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7722337858383845
2021-09-29 04:40:28,987 [INFO] Early stopping criteria is not met.
2021-09-29 04:40:28,987 [INFO] Running epoch 5/20 of training...
2021-09-29 05:23:08,205 [INFO] Running epoch 5/20 of evaluation...
2021-09-29 05:23:48,064 [INFO] Running epoch 5/20 of testing...
2021-09-29 05:24:24,814 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch5.20210929.05.24.24.output.csv...
2021-09-29 05:24:26,718 [INFO] stats:{'epoch': 5, 'train_loss': 0.7184502935652094, 'val_loss': 0.7167081539640758, 'val_acc': 0.7766673950969923, 'runtime': 2637.7288217544556}
2021-09-29 05:24:26,718 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.5.pt...
2021-09-29 05:24:26,947 [INFO] Checking early stopping criteria...
2021-09-29 05:24:26,947 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 05:24:27,285 [INFO] Gathered metrics for epoch 5 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7766673950969923
2021-09-29 05:24:27,285 [INFO] Early stopping criteria is not met.
2021-09-29 05:24:27,285 [INFO] Running epoch 6/20 of training...
2021-09-29 06:07:06,121 [INFO] Running epoch 6/20 of evaluation...
2021-09-29 06:07:47,046 [INFO] Running epoch 6/20 of testing...
2021-09-29 06:08:23,421 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch6.20210929.06.08.23.output.csv...
2021-09-29 06:08:25,326 [INFO] stats:{'epoch': 6, 'train_loss': 0.7012350795025457, 'val_loss': 0.7067181197280394, 'val_acc': 0.780129247304162, 'runtime': 2638.039042234421}
2021-09-29 06:08:25,327 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.6.pt...
2021-09-29 06:08:25,561 [INFO] Checking early stopping criteria...
2021-09-29 06:08:25,562 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 06:08:25,899 [INFO] Gathered metrics for epoch 6 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.780129247304162
2021-09-29 06:08:25,899 [INFO] Early stopping criteria is not met.
2021-09-29 06:08:25,899 [INFO] Running epoch 7/20 of training...
2021-09-29 06:51:06,489 [INFO] Running epoch 7/20 of evaluation...
2021-09-29 06:51:46,596 [INFO] Running epoch 7/20 of testing...
2021-09-29 06:52:23,098 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch7.20210929.06.52.23.output.csv...
2021-09-29 06:52:25,001 [INFO] stats:{'epoch': 7, 'train_loss': 0.6875468996028262, 'val_loss': 0.704508635324833, 'val_acc': 0.781782939128539, 'runtime': 2639.09974527359}
2021-09-29 06:52:25,002 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.7.pt...
2021-09-29 06:52:25,239 [INFO] Checking early stopping criteria...
2021-09-29 06:52:25,239 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 06:52:25,569 [INFO] Gathered metrics for epoch 7 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.781782939128539
2021-09-29 06:52:25,569 [INFO] Early stopping criteria is not met.
2021-09-29 06:52:25,569 [INFO] Running epoch 8/20 of training...
2021-09-29 07:35:06,655 [INFO] Running epoch 8/20 of evaluation...
2021-09-29 07:35:47,255 [INFO] Running epoch 8/20 of testing...
2021-09-29 07:36:23,607 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch8.20210929.07.36.23.output.csv...
2021-09-29 07:36:25,503 [INFO] stats:{'epoch': 8, 'train_loss': 0.676061349012012, 'val_loss': 0.6971487961113374, 'val_acc': 0.7832397997798177, 'runtime': 2639.93199467659}
2021-09-29 07:36:25,504 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.8.pt...
2021-09-29 07:36:25,742 [INFO] Checking early stopping criteria...
2021-09-29 07:36:25,742 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 07:36:26,081 [INFO] Gathered metrics for epoch 8 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7832397997798177
2021-09-29 07:36:26,081 [INFO] Early stopping criteria is not met.
2021-09-29 07:36:26,081 [INFO] Running epoch 9/20 of training...
2021-09-29 08:19:04,201 [INFO] Running epoch 9/20 of evaluation...
2021-09-29 08:19:44,021 [INFO] Running epoch 9/20 of testing...
2021-09-29 08:20:19,704 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch9.20210929.08.20.19.output.csv...
2021-09-29 08:20:21,611 [INFO] stats:{'epoch': 9, 'train_loss': 0.6669968854847786, 'val_loss': 0.6916309484701074, 'val_acc': 0.7851765978584149, 'runtime': 2635.5275349617004}
2021-09-29 08:20:21,612 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.9.pt...
2021-09-29 08:20:21,849 [INFO] Checking early stopping criteria...
2021-09-29 08:20:21,850 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 08:20:22,188 [INFO] Gathered metrics for epoch 9 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7851765978584149
2021-09-29 08:20:22,188 [INFO] Early stopping criteria is not met.
2021-09-29 08:20:22,188 [INFO] Running epoch 10/20 of training...
2021-09-29 09:02:55,185 [INFO] Running epoch 10/20 of evaluation...
2021-09-29 09:03:35,352 [INFO] Running epoch 10/20 of testing...
2021-09-29 09:04:11,560 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch10.20210929.09.04.11.output.csv...
2021-09-29 09:04:13,459 [INFO] stats:{'epoch': 10, 'train_loss': 0.6587825892809097, 'val_loss': 0.6890974319617867, 'val_acc': 0.7858414842620304, 'runtime': 2631.2679572105408}
2021-09-29 09:04:13,459 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.10.pt...
2021-09-29 09:04:13,689 [INFO] Checking early stopping criteria...
2021-09-29 09:04:13,689 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 09:04:14,061 [INFO] Gathered metrics for epoch 10 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7858414842620304
2021-09-29 09:04:14,061 [INFO] Early stopping criteria is not met.
2021-09-29 09:04:14,061 [INFO] Running epoch 11/20 of training...
2021-09-29 09:46:55,794 [INFO] Running epoch 11/20 of evaluation...
2021-09-29 09:47:36,523 [INFO] Running epoch 11/20 of testing...
2021-09-29 09:48:12,430 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch11.20210929.09.48.12.output.csv...
2021-09-29 09:48:14,331 [INFO] stats:{'epoch': 11, 'train_loss': 0.6517333428768355, 'val_loss': 0.6870544114163224, 'val_acc': 0.7865332347627616, 'runtime': 2640.267915725708}
2021-09-29 09:48:14,332 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.11.pt...
2021-09-29 09:48:14,576 [INFO] Checking early stopping criteria...
2021-09-29 09:48:14,577 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 09:48:14,914 [INFO] Gathered metrics for epoch 11 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7865332347627616
2021-09-29 09:48:14,915 [INFO] Early stopping criteria is not met.
2021-09-29 09:48:14,915 [INFO] Running epoch 12/20 of training...
2021-09-29 10:30:52,931 [INFO] Running epoch 12/20 of evaluation...
2021-09-29 10:31:32,697 [INFO] Running epoch 12/20 of testing...
2021-09-29 10:32:09,431 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch12.20210929.10.32.09.output.csv...
2021-09-29 10:32:11,327 [INFO] stats:{'epoch': 12, 'train_loss': 0.6456122037891764, 'val_loss': 0.6877197567781195, 'val_acc': 0.7881073675302958, 'runtime': 2636.4102799892426}
2021-09-29 10:32:11,328 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.12.pt...
2021-09-29 10:32:11,561 [INFO] Checking early stopping criteria...
2021-09-29 10:32:11,561 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 10:32:11,917 [INFO] Gathered metrics for epoch 12 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7881073675302958
2021-09-29 10:32:11,917 [INFO] Early stopping criteria is not met.
2021-09-29 10:32:11,917 [INFO] Running epoch 13/20 of training...
2021-09-29 11:14:55,229 [INFO] Running epoch 13/20 of evaluation...
2021-09-29 11:15:36,021 [INFO] Running epoch 13/20 of testing...
2021-09-29 11:16:12,627 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch13.20210929.11.16.12.output.csv...
2021-09-29 11:16:14,529 [INFO] stats:{'epoch': 13, 'train_loss': 0.6400390767105226, 'val_loss': 0.6840428752039601, 'val_acc': 0.7894950014697761, 'runtime': 2642.6099512577057}
2021-09-29 11:16:14,530 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.13.pt...
2021-09-29 11:16:14,769 [INFO] Checking early stopping criteria...
2021-09-29 11:16:14,770 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 11:16:15,142 [INFO] Gathered metrics for epoch 13 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7894950014697761
2021-09-29 11:16:15,143 [INFO] Early stopping criteria is not met.
2021-09-29 11:16:15,143 [INFO] Running epoch 14/20 of training...
2021-09-29 11:58:52,638 [INFO] Running epoch 14/20 of evaluation...
2021-09-29 11:59:34,039 [INFO] Running epoch 14/20 of testing...
2021-09-29 12:00:10,731 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch14.20210929.12.00.10.output.csv...
2021-09-29 12:00:12,639 [INFO] stats:{'epoch': 14, 'train_loss': 0.635420197576782, 'val_loss': 0.6778903049775562, 'val_acc': 0.7897378115783226, 'runtime': 2637.4942762851715}
2021-09-29 12:00:12,640 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.14.pt...
2021-09-29 12:00:12,881 [INFO] Checking early stopping criteria...
2021-09-29 12:00:12,881 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 12:00:13,236 [INFO] Gathered metrics for epoch 14 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7897378115783226
2021-09-29 12:00:13,236 [INFO] Early stopping criteria is not met.
2021-09-29 12:00:13,236 [INFO] Running epoch 15/20 of training...
2021-09-29 12:42:53,531 [INFO] Running epoch 15/20 of evaluation...
2021-09-29 12:43:34,296 [INFO] Running epoch 15/20 of testing...
2021-09-29 12:44:10,687 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch15.20210929.12.44.10.output.csv...
2021-09-29 12:44:12,589 [INFO] stats:{'epoch': 15, 'train_loss': 0.6303751836193386, 'val_loss': 0.6775502063548791, 'val_acc': 0.7899568572932666, 'runtime': 2639.3506424427032}
2021-09-29 12:44:12,590 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.15.pt...
2021-09-29 12:44:12,827 [INFO] Checking early stopping criteria...
2021-09-29 12:44:12,827 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 12:44:13,175 [INFO] Gathered metrics for epoch 15 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7899568572932666
2021-09-29 12:44:13,175 [INFO] Early stopping criteria is not met.
2021-09-29 12:44:13,175 [INFO] Running epoch 16/20 of training...
2021-09-29 13:26:57,018 [INFO] Running epoch 16/20 of evaluation...
2021-09-29 13:27:37,525 [INFO] Running epoch 16/20 of testing...
2021-09-29 13:28:14,261 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch16.20210929.13.28.14.output.csv...
2021-09-29 13:28:16,170 [INFO] stats:{'epoch': 16, 'train_loss': 0.6263906900286085, 'val_loss': 0.6748642489192883, 'val_acc': 0.7910179891293397, 'runtime': 2642.992109775543}
2021-09-29 13:28:16,170 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.16.pt...
2021-09-29 13:28:16,411 [INFO] Checking early stopping criteria...
2021-09-29 13:28:16,411 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 13:28:16,779 [INFO] Gathered metrics for epoch 16 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7910179891293397
2021-09-29 13:28:16,779 [INFO] Early stopping criteria is not met.
2021-09-29 13:28:16,779 [INFO] Running epoch 17/20 of training...
2021-09-29 14:11:02,907 [INFO] Running epoch 17/20 of evaluation...
2021-09-29 14:11:42,444 [INFO] Running epoch 17/20 of testing...
2021-09-29 14:12:19,012 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch17.20210929.14.12.19.output.csv...
2021-09-29 14:12:20,968 [INFO] stats:{'epoch': 17, 'train_loss': 0.6225597134130503, 'val_loss': 0.676316034693387, 'val_acc': 0.7911378443318563, 'runtime': 2644.1865990161896}
2021-09-29 14:12:20,969 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.17.pt...
2021-09-29 14:12:23,497 [INFO] Checking early stopping criteria...
2021-09-29 14:12:23,497 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-09-29 14:12:23,927 [INFO] Gathered metrics for epoch 17 from wandb:
Empty DataFrame
Columns: [name, epoch, val_acc]
Index: []
best:	None	None
model:	Run-03	0.7911378443318563
2021-09-29 14:12:23,927 [INFO] Early stopping criteria is not met.
2021-09-29 14:12:23,927 [INFO] Running epoch 18/20 of training...
2021-09-29 14:55:09,718 [INFO] Running epoch 18/20 of evaluation...
2021-09-29 14:55:49,971 [INFO] Running epoch 18/20 of testing...
2021-09-29 14:56:26,350 [INFO] Saving test output to /home/ubuntu/output/Run-03.epoch18.20210929.14.56.26.output.csv...
2021-09-29 14:56:28,247 [INFO] stats:{'epoch': 18, 'train_loss': 0.619123798395147, 'val_loss': 0.6737127821320515, 'val_acc': 0.7924505687697638, 'runtime': 2644.316831588745}
2021-09-29 14:56:28,247 [INFO] Saving checkpoint to /home/ubuntu/checkpoints/Run-03.checkpoint.18.pt...
Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/serialization.py", line 372, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/serialization.py", line 491, in _save
    zip_file.write_record(name, storage.data_ptr(), num_bytes)
OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/CMU-11685-HW1P2/run_octopus.py", line 27, in <module>
    main()
  File "/home/ubuntu/CMU-11685-HW1P2/run_octopus.py", line 21, in main
    octopus.run_pipeline()
  File "/home/ubuntu/CMU-11685-HW1P2/octopus/octopus.py", line 167, in run_pipeline
    self.schedulerhandler, self.wandbconnector)
  File "/home/ubuntu/CMU-11685-HW1P2/octopus/handlers/traininghandler.py", line 277, in run_training_epochs
    checkpointhandler.save(model, optimizer, scheduler, epoch + 1, self.stats)
  File "/home/ubuntu/CMU-11685-HW1P2/octopus/handlers/checkpointhandler.py", line 48, in save
    torch.save(checkpoint, filename)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/serialization.py", line 373, in save
    return
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/serialization.py", line 259, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:274] . unexpected pos 135095872 vs 135095760